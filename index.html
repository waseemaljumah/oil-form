<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>نموذج متابعة تغيير الزيت</title>
  <!-- ربط ملف CSS الخارجي -->
  <link rel="stylesheet" href="style.css" />
  <style>
    /* إظهار/إخفاء الحقول الأخرى بشكل افتراضي */
    input#typeOther,
    input#filterOther,
    input#lastKmOther {
      display: none;
      margin-top: 5px;
    }
  </style>
</head>
<body>

<h2>نموذج إدخال بيانات المركبات</h2>

<div class="card">
  <label>رقم المعدة</label>
  <input id="number" />

  <label>نوع المعدة</label>
  <select id="type">
    <option value="قلاب فولفو">قلاب فولفو</option>
    <option value="قلاب مرسيدس">قلاب مرسيدس</option>
    <option value="شيول">شيول</option>
    <option value="بلدوزر">بلدوزر</option>
    <option value="بوبكات">بوبكات</option>
    <option value="اخرى">أخرى</option>
  </select>
  <input id="typeOther" placeholder="اكتب نوع المعدة إذا اخترت 'أخرى'" />

  <label>تاريخ آخر تغيير زيت</label>
  <input type="date" id="date" />

  <label>فلتر الزيت</label>
  <select id="filter">
    <option value="تم تغييره في آخر تغيير">تم تغييره في آخر تغيير</option>
    <option value="تم تغييره في التغيير قبل الأخير">تم تغييره في التغيير قبل الأخير</option>
    <option value="لم يتم تغييره في آخر تغييرين">لم يتم تغييره في آخر تغييرين</option>
    <option value="اخرى">أخرى</option>
  </select>
  <input id="filterOther" placeholder="اكتب حالة الفلتر إذا اخترت 'أخرى'" />

  <label>الممشى الحالي</label>
  <input type="number" id="currentKm" />

  <label>ممشى آخر تغيير زيت</label>
  <input type="number" id="lastKm" />
  <select id="lastKmSelect">
    <option value="">يوجد ممشى لآخر تغيير زيت</option>
    <option value="اخرى">أخرى</option>
  </select>
  <input id="lastKmOther" placeholder="اكتب الملاحظة إذا اخترت 'أخرى'" />

  <button onclick="addVehicle()">إضافة المركبة</button>
</div>

<div class="card">
  <h3>النص الجاهز للإرسال</h3>
  <div id="output"></div>
  <button onclick="copyText()">نسخ النص</button>
</div>

<script>
  const typeSelect = document.getElementById('type');
  const typeOther = document.getElementById('typeOther');
  typeSelect.addEventListener('change', () => {
    typeOther.style.display = typeSelect.value === 'اخرى' ? 'block' : 'none';
  });

  const filterSelect = document.getElementById('filter');
  const filterOther = document.getElementById('filterOther');
  filterSelect.addEventListener('change', () => {
    filterOther.style.display = filterSelect.value === 'اخرى' ? 'block' : 'none';
  });

  const lastKmSelect = document.getElementById('lastKmSelect');
  const lastKmOther = document.getElementById('lastKmOther');
  lastKmSelect.addEventListener('change', () => {
    lastKmOther.style.display = lastKmSelect.value === 'اخرى' ? 'block' : 'none';
  });

  let vehicles = [];

  function addVehicle() {
    const currentKm = document.getElementById('currentKm');
    const lastKm = document.getElementById('lastKm');
    const lastKmSel = document.getElementById('lastKmSelect');
    const lastKmO = document.getElementById('lastKmOther');
    const number = document.getElementById('number');
    const type = document.getElementById('type');
    const date = document.getElementById('date');
    const filter = document.getElementById('filter');
    const filterO = document.getElementById('filterOther');

    const diff = Number(currentKm.value) - Number(lastKm.value);
    const formattedDate = date.value ? date.value.replace(/-/g, '/') : '';
    const typeText = type.value === 'اخرى' ? typeOther.value : type.value;
    const filterText = filter.value === 'اخرى' ? filterO.value : filter.value;
    const lastKmText = lastKmSel.value === 'اخرى' ? lastKmO.value : lastKm.value;

    const text = `رقم المعدة: ${number.value}
نوع المعدة: ${typeText}
الممشى منذ اخر تغيير: ${diff}
تاريخ آخر تغيير زيت: ${formattedDate}
حالة فلتر الزيت: ${filterText}
----------------------`;

    vehicles.push(text);
    document.getElementById('output').innerText = vehicles.join("\n");

    // مسح الحقول
    document.querySelectorAll('input').forEach(i => i.value = "");
    document.querySelectorAll('select').forEach(s => s.value = s.options[0].value);
    typeOther.style.display = 'none';
    filterOther.style.display = 'none';
    lastKmOther.style.display = 'none';
  }

  function copyText() {
    const output = document.getElementById('output');
    navigator.clipboard.writeText(output.innerText);
    alert('تم النسخ');
  }
</script>

</body>
</html>